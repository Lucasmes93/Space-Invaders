{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/Users/Achraf/Desktop/SpaceInvader/react_space_invader/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _slicedToArray from\"C:/Users/Achraf/Desktop/SpaceInvader/react_space_invader/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{Ship}from\"../Component/Ship/Ship\";import{Bullet}from\"../Component/Bullet/Bullet\";import{SFX}from\"../Component/SFX\";import{Alien}from\"../Component/Alien/Alien\";import{useDispatch}from\"react-redux\";import{useNavigate}from'react-router-dom';import Score from\"../Component/Score/Score\";import'./GameWindow.css';import'../Component/Ship/Ship.css';import'../Component/Bullet/Bullet.css';import'../Component/Alien/Alien.css';import'../Component/Score/Score.css';import'../Component/Lives/Lives.css';import shipLive from'../Assets/ShipImg/ship.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Audio=new SFX();function GameWindow(props){//################################### Audio Initialisation ###################################################\nvar _useState=useState(true),_useState2=_slicedToArray(_useState,2),toggle=_useState2[0],setToggle=_useState2[1];var dispatch=useDispatch();var play=function play(){if(toggle){Audio.music.play();Audio.music.loop=true;}else{Audio.music.pause();}setToggle(!toggle);};var incrFunction=function incrFunction(){dispatch({type:\"INCR\"//nom de l'action\n});};var decrFunction=function decrFunction(){dispatch({type:\"DECR\"//nom de l'action\n});};var nav=useNavigate();useEffect(function(){//###################################  const and fonctions Initialisation ###################################################\nvar bullets=[];var creatBullet=function creatBullet(_ref){var x=_ref.x,y=_ref.y,nomDeClassCSS=_ref.nomDeClassCSS,_ref$isAlien=_ref.isAlien,isAlien=_ref$isAlien===void 0?false:_ref$isAlien;bullets.push(new Bullet({x:x,y:y,nomDeClassCSS:nomDeClassCSS,isAlien:isAlien}));};var shipHits=function shipHits(){var life=document.querySelectorAll(\".ship-lives\");if(life.length>1){life[life.length-1].remove();}else{nav('/gameover');clearInterval(fireInterval);}};var aliens=[];// const alienGrid = []; //TA\nvar conteur=0;var item=document.querySelector(\".game_window\");var style=getComputedStyle(item);var min_x=parseInt(style.marginLeft);var max_x=document.body.offsetWidth-min_x-200;var max_y=item.offsetHeight;var Alien_Raws=3;// let Alien_Col = 0;\nvar removeAlien=function removeAlien(alien){aliens.splice(aliens.indexOf(alien),1);alien.remove();};var removeBullet=function removeBullet(bullet){bullets.splice(bullets.indexOf(bullet),1);bullet.remove();if(bullet.isAlien){decrFunction();shipHits();}else{incrFunction();win();}};var isOverlapping=function isOverlapping(element1,element2){//code source :https://stackoverflow.com/questions/12066870/how-to-check-if-an-element-is-overlapping-other-elements\n//pour savoir si deux element du dom se superposent\nvar rect1=element1.el.getBoundingClientRect();var rect2=element2.el.getBoundingClientRect();return!(rect1.right<rect2.left||rect1.left>rect2.right||rect1.bottom<rect2.top||rect1.top>rect2.bottom);};var getOverlappingBullet=function getOverlappingBullet(entity){var _iterator=_createForOfIteratorHelper(bullets),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var bullet=_step.value;if(isOverlapping(entity,bullet)){return bullet;}}}catch(err){_iterator.e(err);}finally{_iterator.f();}return null;};//################################### ship Initialisation ###################################################\nvar ship=new Ship({getOverlappingBullet:getOverlappingBullet,removeBullet:removeBullet});//################################### Aliens Initialisation ###################################################\nfor(var row=0;row<Alien_Raws;row++){// const alienCol = []; //pour le tir alien (TA)\nfor(var col=0;conteur<max_x;col++){var alien=new Alien({x:min_x+120*col,y:row*100+10,getOverlappingBullet:getOverlappingBullet,removeAlien:removeAlien,removeBullet:removeBullet});conteur=min_x+120*col;aliens.push(alien);// alienCol.push(alien); //TA\n}conteur=0;// alienGrid.push(alienCol);//TA\n}var getLeftMostAlien=function getLeftMostAlien(){return aliens.reduce(function(minimumAlien,currantAlien){return currantAlien.x<minimumAlien.x?currantAlien:minimumAlien;});};var getRightMostAlien=function getRightMostAlien(){return aliens.reduce(function(maximumAlien,currantAlien){return currantAlien.x>maximumAlien.x?currantAlien:maximumAlien;});};//################################### ship Control ###################################################\nvar keys={d:false,q:false,' ':false};window.addEventListener('keydown',function(e){keys[e.key]=true;//console.log(keys)\n});window.addEventListener('keyup',function(e){keys[e.key]=false;});var interval=setInterval(function(){if(keys['d']&&ship.x<document.querySelector(\".game_window\").offsetWidth-90){ship.moveRight();}if(keys['q']&&ship.x>5){ship.moveLeft();}if(keys[' ']){ship.fire({creatBullet:creatBullet});//on passe une fonction a notre class\n}ship.shipUpdate();bullets.forEach(function(bullet){bullet.move();if(bullet.y<0||bullet.y>max_y){//quand le tir sort de l'écran\nbullet.remove();bullets.splice(bullets.indexOf(bullet),1);//supprimer un element du tableau bullets\n}});//################################### Alien Control ###################################################\naliens.forEach(function(alien){alien.update();});var maxLeftAlien=getLeftMostAlien();if(maxLeftAlien.x<min_x){aliens.forEach(function(alien){alien.setDirectionRight();});}var maxRightAlien=getRightMostAlien();if(maxRightAlien.x>document.body.offsetWidth-min_x-100){aliens.forEach(function(alien){alien.setDirectionLeft();});}},20);aliens.forEach(function(alien){alien.moveDown();});var fireInterval=setInterval(function(){var alien=aliens[Math.floor(Math.random()*aliens.length)];alien.fireAlien({creatBullet:creatBullet});},3000);// //###################################### Alien fire Random #############################################\n//\n// Alien_Col = alienGrid[0].length;\n// //on parcours toutes les lignes de toutes les colonnes pour determiner le plus bas\n// const getBottomAliens = () => {\n//     const bottomAliens = [];\n//     for (let col = 0 ; col < Alien_Col ; col++){\n//         for (let row = Alien_Raws - 1 ; row >= 0 ; row--){\n//             if (alienGrid[row][col]) {\n//                 bottomAliens.push(alienGrid[row][col]);\n//                 break;\n//             }\n//         }\n//     }\n//     return bottomAliens;\n// };\n//\n// const getRandomAlien = (alienList) => {\n//     return alienList[\n//         parseInt(Math.random()*alienList.length) //avoir un chiffre random depuis un array\n//         ];\n// };\n//\n// const aliensFireBullet = () => {\n//     const bottomAliens = getBottomAliens();\n//     const randomAlien = getRandomAlien(bottomAliens);\n//     //fire depuis un Alien random\n//     creatBullet({\n//         x: randomAlien.x,\n//         y: randomAlien.y,\n//         nomDeClassCSS: 'bullet-Alien',\n//         isAlien: true\n//     });\n//\n// };\n//\n// const intervalForAlienShot = setInterval (()=>{\n//     aliensFireBullet();\n// }, 3000);\nvar win=function win(){if(aliens.length===0){nav('/gameover');}};return function(){clearInterval(interval);// clearInterval(intervalForAlienShot);\n};},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:play,children:\"Audio\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"game_window\",children:[/*#__PURE__*/_jsx(Score,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"Lives\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Vie: \"}),/*#__PURE__*/_jsx(\"img\",{src:shipLive,alt:\"\",className:\"ship-lives\"}),/*#__PURE__*/_jsx(\"img\",{src:shipLive,alt:\"\",className:\"ship-lives\"}),/*#__PURE__*/_jsx(\"img\",{src:shipLive,alt:\"\",className:\"ship-lives\"})]})]})]});}export default GameWindow;","map":{"version":3,"sources":["C:/Users/Achraf/Desktop/SpaceInvader/react_space_invader/src/Containers/GameWindow.js"],"names":["React","useState","useEffect","Ship","Bullet","SFX","Alien","useDispatch","useNavigate","Score","shipLive","Audio","GameWindow","props","toggle","setToggle","dispatch","play","music","loop","pause","incrFunction","type","decrFunction","nav","bullets","creatBullet","x","y","nomDeClassCSS","isAlien","push","shipHits","life","document","querySelectorAll","length","remove","clearInterval","fireInterval","aliens","conteur","item","querySelector","style","getComputedStyle","min_x","parseInt","marginLeft","max_x","body","offsetWidth","max_y","offsetHeight","Alien_Raws","removeAlien","alien","splice","indexOf","removeBullet","bullet","win","isOverlapping","element1","element2","rect1","el","getBoundingClientRect","rect2","right","left","bottom","top","getOverlappingBullet","entity","ship","row","col","getLeftMostAlien","reduce","minimumAlien","currantAlien","getRightMostAlien","maximumAlien","keys","d","q","window","addEventListener","e","key","interval","setInterval","moveRight","moveLeft","fire","shipUpdate","forEach","move","update","maxLeftAlien","setDirectionRight","maxRightAlien","setDirectionLeft","moveDown","Math","floor","random","fireAlien"],"mappings":"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","sourcesContent":["import React, {useState,useEffect} from 'react';\r\nimport {Ship} from \"../Component/Ship/Ship\";\r\nimport {Bullet} from \"../Component/Bullet/Bullet\";\r\nimport {SFX} from \"../Component/SFX\";\r\nimport {Alien} from \"../Component/Alien/Alien\";\r\nimport {useDispatch} from \"react-redux\";\r\nimport {useNavigate} from 'react-router-dom'\r\nimport Score from \"../Component/Score/Score\";\r\nimport './GameWindow.css';\r\nimport '../Component/Ship/Ship.css'\r\nimport '../Component/Bullet/Bullet.css'\r\nimport '../Component/Alien/Alien.css'\r\nimport '../Component/Score/Score.css'\r\nimport '../Component/Lives/Lives.css'\r\nimport shipLive from '../Assets/ShipImg/ship.png'\r\n\r\n\r\nconst Audio = new SFX();\r\n\r\n\r\nfunction GameWindow(props) {\r\n\r\n    //################################### Audio Initialisation ###################################################\r\n\r\n    const [toggle, setToggle] = useState(true);\r\n    const dispatch = useDispatch();\r\n\r\n\r\n    const play = () => {\r\n        if (toggle) {\r\n            Audio.music.play();\r\n            Audio.music.loop = true;\r\n        }else {\r\n            Audio.music.pause()\r\n        }\r\n        setToggle(!toggle);\r\n    }\r\n\r\n\r\n    const incrFunction = () => {\r\n        dispatch({\r\n            type: \"INCR\"  //nom de l'action\r\n        })\r\n    }\r\n    const decrFunction = () => {\r\n        dispatch({\r\n            type: \"DECR\"  //nom de l'action\r\n        })\r\n    }\r\n    const nav = useNavigate();\r\n\r\n\r\n\r\n\r\n    useEffect(()=>{\r\n\r\n\r\n\r\n        //###################################  const and fonctions Initialisation ###################################################\r\n\r\n\r\n\r\n\r\n        const bullets = [];\r\n        const creatBullet = ({x,y,nomDeClassCSS, isAlien = false}) => {\r\n            bullets.push(new Bullet ({\r\n                x,\r\n                y,\r\n                nomDeClassCSS,\r\n                isAlien\r\n            }));\r\n        }\r\n\r\n\r\n\r\n        const shipHits = () => {\r\n            let life = document.querySelectorAll(\".ship-lives\")\r\n            if (life.length > 1){\r\n                life[life.length-1].remove()\r\n            }\r\n            else {\r\n                nav('/gameover');\r\n                clearInterval(fireInterval);\r\n            }\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n        const aliens = [];\r\n        // const alienGrid = []; //TA\r\n        let conteur = 0;\r\n\r\n        const item = document.querySelector(\".game_window\");\r\n        const style = getComputedStyle(item)\r\n        let min_x =parseInt(style.marginLeft)\r\n        let max_x = document.body.offsetWidth - min_x - 200\r\n        let max_y = item.offsetHeight\r\n        let Alien_Raws = 3;\r\n        // let Alien_Col = 0;\r\n\r\n\r\n\r\n\r\n\r\n        const removeAlien = (alien) => {\r\n            aliens.splice(aliens.indexOf(alien),1);\r\n            alien.remove();\r\n        };\r\n        const removeBullet = (bullet) => {\r\n            bullets.splice(bullets.indexOf(bullet),1);\r\n            bullet.remove();\r\n            if (bullet.isAlien){\r\n                decrFunction();\r\n                shipHits();\r\n            }else {\r\n                incrFunction();\r\n                win();\r\n            }\r\n\r\n        };\r\n\r\n        const isOverlapping = (element1, element2) => {\r\n            //code source :https://stackoverflow.com/questions/12066870/how-to-check-if-an-element-is-overlapping-other-elements\r\n            //pour savoir si deux element du dom se superposent\r\n            const rect1 = element1.el.getBoundingClientRect();\r\n            const rect2 = element2.el.getBoundingClientRect();\r\n\r\n            return !(rect1.right < rect2.left ||\r\n                rect1.left > rect2.right ||\r\n                rect1.bottom < rect2.top ||\r\n                rect1.top > rect2.bottom)\r\n        }\r\n\r\n        const getOverlappingBullet = (entity) => {\r\n            for (let bullet of bullets) {\r\n                if (isOverlapping(entity, bullet)) {\r\n                    return bullet\r\n                }\r\n            }return null;\r\n        }\r\n\r\n\r\n        //################################### ship Initialisation ###################################################\r\n\r\n        const ship = new Ship({\r\n            getOverlappingBullet,\r\n            removeBullet\r\n        });\r\n\r\n        //################################### Aliens Initialisation ###################################################\r\n\r\n        for (let row = 0; row < Alien_Raws  ; row ++) {\r\n            // const alienCol = []; //pour le tir alien (TA)\r\n            for (let col = 0 ; conteur < max_x ; col++) {\r\n                const alien = new Alien({\r\n                    x: min_x + 120 * col ,\r\n                    y: row * 100 + 10,\r\n                    getOverlappingBullet,\r\n                    removeAlien,\r\n                    removeBullet\r\n                });\r\n\r\n                conteur = min_x + 120 * col ;\r\n                aliens.push(alien);\r\n                // alienCol.push(alien); //TA\r\n\r\n            }\r\n            conteur = 0;\r\n            // alienGrid.push(alienCol);//TA\r\n        }\r\n\r\n\r\n\r\n        const getLeftMostAlien = () => {\r\n            return aliens.reduce((minimumAlien, currantAlien) => {\r\n                return currantAlien.x < minimumAlien.x ? currantAlien : minimumAlien;\r\n            });\r\n        };\r\n        const getRightMostAlien = () => {\r\n            return aliens.reduce((maximumAlien, currantAlien) => {\r\n                return currantAlien.x > maximumAlien.x ? currantAlien : maximumAlien;\r\n            });\r\n        };\r\n\r\n        //################################### ship Control ###################################################\r\n\r\n        const keys = {\r\n            d:false,\r\n            q:false,\r\n            ' ':false\r\n        }\r\n\r\n        window.addEventListener('keydown', e => {\r\n            keys[e.key] = true;\r\n            //console.log(keys)\r\n        })\r\n        window.addEventListener('keyup', e => {\r\n            keys[e.key] = false;\r\n        })\r\n\r\n        const interval = setInterval(() => {\r\n            if (keys['d'] && ship.x < document.querySelector(\".game_window\").offsetWidth - 90 ) {\r\n                ship.moveRight()\r\n\r\n            }\r\n            if (keys['q'] && ship.x >  5) {\r\n                ship.moveLeft()\r\n\r\n            }\r\n            if (keys[' ']) {\r\n                ship.fire({creatBullet}); //on passe une fonction a notre class\r\n            }\r\n\r\n            ship.shipUpdate()\r\n\r\n            bullets.forEach(bullet => {\r\n                bullet.move();\r\n                if (bullet.y < 0 || bullet.y > max_y) {   //quand le tir sort de l'écran\r\n                    bullet.remove();\r\n                    bullets.splice(bullets.indexOf(bullet),1);//supprimer un element du tableau bullets\r\n                }\r\n            });\r\n\r\n\r\n            //################################### Alien Control ###################################################\r\n\r\n            aliens.forEach(alien => {\r\n                alien.update()\r\n            })\r\n\r\n\r\n            const maxLeftAlien = getLeftMostAlien();\r\n\r\n            if (maxLeftAlien.x <  min_x) {\r\n                aliens.forEach(alien => {\r\n                    alien.setDirectionRight()\r\n                })\r\n            }\r\n\r\n            const maxRightAlien = getRightMostAlien();\r\n            if (maxRightAlien.x > document.body.offsetWidth - min_x - 100) {\r\n                aliens.forEach(alien => {\r\n                    alien.setDirectionLeft()\r\n                })\r\n            }\r\n\r\n\r\n\r\n\r\n\r\n\r\n        }, 20);\r\n\r\n        aliens.forEach(alien => {\r\n            alien.moveDown()\r\n        })\r\n\r\n        const fireInterval = setInterval (() => {\r\n           let alien = aliens[Math.floor(Math.random()*aliens.length)];\r\n           alien.fireAlien({creatBullet});\r\n        }, 3000)\r\n\r\n        // //###################################### Alien fire Random #############################################\r\n        //\r\n        // Alien_Col = alienGrid[0].length;\r\n        // //on parcours toutes les lignes de toutes les colonnes pour determiner le plus bas\r\n        // const getBottomAliens = () => {\r\n        //     const bottomAliens = [];\r\n        //     for (let col = 0 ; col < Alien_Col ; col++){\r\n        //         for (let row = Alien_Raws - 1 ; row >= 0 ; row--){\r\n        //             if (alienGrid[row][col]) {\r\n        //                 bottomAliens.push(alienGrid[row][col]);\r\n        //                 break;\r\n        //             }\r\n        //         }\r\n        //     }\r\n        //     return bottomAliens;\r\n        // };\r\n        //\r\n        // const getRandomAlien = (alienList) => {\r\n        //     return alienList[\r\n        //         parseInt(Math.random()*alienList.length) //avoir un chiffre random depuis un array\r\n        //         ];\r\n        // };\r\n        //\r\n        // const aliensFireBullet = () => {\r\n        //     const bottomAliens = getBottomAliens();\r\n        //     const randomAlien = getRandomAlien(bottomAliens);\r\n        //     //fire depuis un Alien random\r\n        //     creatBullet({\r\n        //         x: randomAlien.x,\r\n        //         y: randomAlien.y,\r\n        //         nomDeClassCSS: 'bullet-Alien',\r\n        //         isAlien: true\r\n        //     });\r\n        //\r\n        // };\r\n        //\r\n        // const intervalForAlienShot = setInterval (()=>{\r\n        //     aliensFireBullet();\r\n        // }, 3000);\r\n\r\n        const win = () => {\r\n            if (aliens.length === 0) {\r\n                nav('/gameover');\r\n            }\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        return () => {\r\n            clearInterval(interval);\r\n            // clearInterval(intervalForAlienShot);\r\n        }\r\n    },[])\r\n\r\n    return (\r\n        <>\r\n            <button onClick={play}>Audio</button>\r\n            <div className='game_window' >\r\n                <Score/>\r\n                <div className=\"Lives\">\r\n                    <h2>Vie: </h2>\r\n                    <img src={shipLive} alt=\"\" className=\"ship-lives\"/>\r\n                    <img src={shipLive} alt=\"\" className=\"ship-lives\"/>\r\n                    <img src={shipLive} alt=\"\" className=\"ship-lives\"/>\r\n                </div>\r\n\r\n\r\n            </div>\r\n\r\n        </>\r\n\r\n    );\r\n}\r\n\r\nexport default GameWindow;"]},"metadata":{},"sourceType":"module"}